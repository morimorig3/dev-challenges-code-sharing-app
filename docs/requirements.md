# NoteCode - コード共有アプリ 要件定義書

## 1. プロジェクト概要

NoteCodeは、ユーザーがコードスニペットを保存し、一意のIDで共有できるフルスタックのコード共有アプリケーションです。

## 2. ユーザーストーリー

1. 提供されたデザインに従ってコード共有アプリを作成する
2. 初期読み込み時にデフォルトのHTMLスニペットを表示する
3. ユーザーが「Share」ボタンをクリックすると一意のIDを生成する
4. コードが保存された後、編集が行われるまで「Share」ボタンを無効化する
5. スニペットの言語とテーマを選択できるようにする
6. すべてのデバイスでレスポンシブデザインを確保する
7. リポジトリURLとデモURLを含むソリューションをデプロイする

## 3. 主要機能

### 3.1 共有機能

- **初期状態**: Shareボタンが有効
- **共有時**:
  - 一意のIDを生成
  - コードをデータベースに保存（手動保存）
  - Shareボタンを無効化
  - 「Copy Link」オプションを表示
  - 生成されたURLをクリップボードにコピー可能にする
- **編集時**: コードを編集するとShareボタンを再度有効化
- **アクセス**: 他のユーザーは一意のURL（例: `/snippet/:id`）を介してコードにアクセスし、閲覧・変更が可能

### 3.2 デフォルトコンテンツ

初期読み込み時に、以下のサンプルHTMLコードをエディタに表示：

```html
<html>
  <head>
    <title>HTML Sample</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <style type="text/css">
      h1 { color: #cca3a3; }
    </style>
    <script type="text/javascript">
      alert("I am a sample... visit devChallenges.io for more projects");
    </script>
  </head>
  <body>
    <h1>Heading No.1</h1>
    <input disabled type="button" value="Click me" />
  </body>
</html>
```

**含まれる要素：**
- JavaScriptアラート（サンプルメッセージを表示）
- スタイル付き見出し（`#cca3a3`カラーのh1要素）
- 無効化されたボタン（`disabled`属性付きのinput要素）

### 3.3 コードエディタ

- Monaco Editorまたは代替エディタ（CodeMirror、Ace Editorなど）を使用
- コードの編集機能を提供

### 3.4 言語とテーマの選択

- **言語選択**: 複数のプログラミング言語に対応（HTML, CSS, JavaScript, Python, Java等）
  - 使用するエディタライブラリ（Monaco Editor等）が提供する言語リストから選択
- **テーマ選択**: 複数のエディタテーマから選択可能（例: VS Dark, Light, High Contrast等）
  - 使用するエディタライブラリが提供するテーマから選択
- 選択した言語とテーマはスニペットとともに保存され、共有時も反映される

### 3.5 レスポンシブデザイン

- **対応デバイス**:
  - デスクトップ: 1350px 幅を基準
  - モバイル: 412px 幅を基準
- デザインモックアップが両ビューポートサイズで提供されている
- メディアクエリ、Flexbox、Gridを使用してレスポンシブ対応を実装

## 4. 技術要件

### 4.1 フロントエンド

（あとで記入）

### 4.2 バックエンド

（あとで記入）

### 4.3 データベース

（あとで記入）

### 4.4 API仕様

（あとで記入）

### 4.5 デプロイメント

（あとで記入）

## 5. 非機能要件

### 5.1 パフォーマンス

- **初期読み込み時間**: 3秒以内（通常のネットワーク環境下）
- **コードの保存**: 1秒以内にレスポンスを返す
- **コードの取得**: 共有URLアクセス時、2秒以内にエディタに表示
- **エディタの起動**: ページ読み込み後、1秒以内にエディタが操作可能になる

### 5.2 セキュリティ

- **一意のID生成**:
  - UUIDv4 または nanoid（21文字）を使用
  - 推測・列挙攻撃に対して耐性のあるランダムなIDを生成
  - 例: `7a3f9c2b-e5d1-4a8c-9b6f-2e4d8c1a5b7c` (UUID) または `V1StGXR8_Z5jdHi6B-myT` (nanoid)
- **入力検証**:
  - コードの最大文字数制限（例: 100KB）
  - 言語とテーマの選択肢を検証
- **エラーハンドリング**:
  - 不正なスニペットIDへのアクセス時: 404エラーと「スニペットが見つかりません」メッセージ
  - データベース接続エラー時: 500エラーと「サーバーエラーが発生しました」メッセージ
  - 保存失敗時: 適切なエラーメッセージをユーザーに表示
- **CORS設定**: 必要に応じて適切なCORS設定を実装

### 5.3 ユーザビリティ

- **ユーザーインターフェース**:
  - 提供されたデザインモックアップに忠実に実装
  - コードエディタは画面の大部分を占め、コードの視認性を確保
  - 言語・テーマ選択はドロップダウンまたは選択可能なUI要素で提供
  - Shareボタンは目立つ位置に配置し、状態（有効/無効）が視覚的に分かりやすい
- **フィードバック**:
  - 保存成功時: 「スニペットを保存しました」等のメッセージ表示
  - URLコピー成功時: 「URLをコピーしました」等のトースト通知
  - エラー発生時: 具体的なエラー内容をユーザーに表示
  - ローディング状態: 保存中・読み込み中はローディングインジケーターを表示
- **保存動作**: 手動保存（Shareボタンクリック時）
  - 自動保存機能は不要
  - コード編集中はShareボタンが有効化され、保存可能な状態を示す
  - 保存後は再度編集するまでShareボタンを無効化

### 5.4 スケーラビリティ

- **想定規模**:
  - 同時アクセス: 100ユーザー程度に対応（個人プロジェクトレベル）
  - スニペット数: 10,000件程度のデータを効率的に管理
- **データベース設計**:
  - 適切なインデックス設定（スニペットIDでの高速検索）
  - 必要に応じてページネーションを実装（将来的な拡張）

## 6. 制約事項

- 提供されたデザインに従う必要がある
- レスポンシブデザインが必須
- デプロイ可能な状態でソリューションを提供する必要がある

## 7. 成果物

- ソースコードリポジトリ（GitHub等）
- デプロイされたアプリケーションのデモURL
- README.md（セットアップ手順、使用技術の説明を含む）

## 8. 参考情報

### 8.1 チャレンジ情報
- チャレンジURL: https://devchallenges.io/challenge/code-shraing-app-note-code
- フルスタック学習パス: https://devchallenges.io/learn/5-fullstack

### 8.2 推奨デプロイサービス（2025年版・無料枠あり）

#### フルスタック一括デプロイ
- **Railway** (推奨)
  - フロントエンド、バックエンド、DBを一箇所で管理
  - トライアルあり、有料プラン $5/月〜
  - GitHub連携、永続ストレージ、リアルタイムログ

- **Render**
  - シンプルで強力、サービス間プライベートネットワーク対応
  - 無料プランあり
  - フルスタックアプリに最適

#### 分離デプロイ構成
- **フロントエンド**:
  - **Vercel**: Next.js に最適、無料プラン（個人利用）、100GB転送/月
  - **Netlify**: Git統合が優秀、無料プラン（個人利用）、有料 $19/月〜

- **バックエンド + データベース**:
  - **Railway** または **Render**（上記参照）
  - **Supabase**: PostgreSQL、認証機能付き、無料プランあり

#### 推奨構成例
1. **シンプル構成**: Railway（フロントエンド + バックエンド + DB すべて）
2. **分離構成**: Vercel（フロントエンド）+ Railway（バックエンド + DB）
